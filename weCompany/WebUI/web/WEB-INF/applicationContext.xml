<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:sec="http://www.springframework.org/schema/security"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context.xsd
                           http://www.springframework.org/schema/security
                           http://www.springframework.org/schema/security/spring-security.xsd">

    <context:property-placeholder location="/WEB-INF/jdbc.properties"/>
    <bean id="dataSource" class="org.apache.commons.dbcp2.BasicDataSource" destroy-method="close"
            p:driverClassName="${jdbc.driverClassName}"
            p:url="${jdbc.url}"
            p:username="${jdbc.username}"
            p:password="${jdbc.password}"/>

    <bean id="userDetailsService"
          class="org.springframework.security.core.userdetails.jdbc.JdbcDaoImpl"
          p:dataSource-ref="dataSource" />

    <sec:authentication-manager>
        <sec:authentication-provider user-service-ref="userDetailsService" />
    </sec:authentication-manager>

    <sec:http>
        <!--公司领导-->
        <sec:intercept-url pattern="/president_portal/**" access="ROLE_PRESIDENT" />
        <!--发展规划部-->
        <sec:intercept-url pattern="/president_fzghb/**" access="ROLE_FZGHB"/>
        <!--部门审核者-->
        <sec:intercept-url pattern="/manager_portal/**" access="ROLE_MANAGER" />
        <!--公司员工-->
        <sec:intercept-url pattern="/user/**" access="ROLE_USER" />

        <sec:form-login login-page="/login.jsp" />

        <sec:logout />
    </sec:http>
</beans>